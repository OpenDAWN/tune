<!DOCTYPE html>
<html>
  <head>
     
      <script src="js/Tone.min.js"></script>
      <script src="js/tune.js"></script>
      <script src="js/tunings.js"></script>
      <script src="js/three.min.js"></script>
      <script src="js/audiokeys.js"></script>
      <script src="js/nexusUI.js"></script>
      <script src="js/qwerty-hancock.js"></script>
      <link href='http://fonts.googleapis.com/css?family=Hammersmith+One' rel='stylesheet' type='text/css'>
      <link rel='stylesheet' href='style.css'>

  </head>

  <body>

    <h1>Tune.js Demo</h1>
    <h2> A Web Audio Microtonal Piano</h2>
    <h3> Use your computer keyboard to play</h3>
  
  <div id="keyboard">
      

  </div>
    
      <div id="scales">
        <p>Scale Choices</p>
        <canvas nx="select" choices="ptolemy,ji_12,harm30,pyth_31,partch_43,johnston_81,xenakis_chrom,helmholtz_pure,05-19,couperin"></canvas>
        <p> Visit <a href="http://abbernie.github.io/tune/scales.html"> the archive</a> for a full list of scales with descriptions
      </div>
    </div>

    <div id="loading">
      Loading Samples...
    </div>

  </body>
  <script>
      
  /*
  *
  * Interface
  *
  */

    var keyboard = new QwertyHancock({
                 id: 'keyboard',
                 width: 600,
                 height: 150,
                 octaves: 1,
                 startNote: 'c4',
                 whiteNotesColour: 'white',
                 blackNotesColour: 'black',
                 hoverColour: '#f00'
            });
    var gui = document.getElementById('keyboard')
    gui.style.margin = '65px auto'
    gui.style.padding = '20px'

   nx.onload = function(){
    
    select1.on('*',function(){
      var scale = select1.val.text;
      tune.loadScale(scale);

    });

  }

  var scales = document.getElementById('scales')
  scales.style.width = '300px';
  scales.style.height = '100px';
  scales.style.top = '-100px'

  var loading = document.getElementById('loading')
  
  loading.style.left = '40%';
  loading.style.top = '40%';
  loading.style.padding = '50px';


    
    /*
    *
    *
    * AUDIO SYNTHESIS CODE
    *
    *
    */

    // Create a new Tune object
    var tune = new Tune();
    // Load a 12 tone just intonation scale
    tune.loadScale('ptolemy');
    // Set the output mode to 'MIDI' 
    tune.mode.output = 'MIDI';

    //tune.setKey(69);

    var actx = new (AudioContext || wedkitAudioContext)();

    var piano = new Tone.Sampler({
            
            12:"samples/c4.mp3",
            13:"samples/c4.mp3",
            14:"samples/c4.mp3",
            15:"samples/c4.mp3",
            16:"samples/c4.mp3",
            17:"samples/c4.mp3",
            18:"samples/c4.mp3",
            19:"samples/c4.mp3",
            20:"samples/c4.mp3",
            21:"samples/c4.mp3",
            22:"samples/c4.mp3",
            23:"samples/c4.mp3",
            
            24:"samples/c4.mp3",
            25:"samples/c4.mp3",
            26:"samples/c4.mp3",
            27:"samples/c4.mp3",
            28:"samples/c4.mp3",
            29:"samples/c4.mp3",
            30:"samples/c4.mp3",
            31:"samples/c4.mp3",
            32:"samples/c4.mp3",
            33:"samples/c4.mp3",
            34:"samples/c4.mp3",
            35:"samples/c4.mp3",
            
            36:"samples/c4.mp3",
            37:"samples/c4.mp3",
            38:"samples/c4.mp3",
            39:"samples/c4.mp3",
            40:"samples/c4.mp3",
            41:"samples/c4.mp3",
            42:"samples/c4.mp3",
            43:"samples/c4.mp3",
            44:"samples/c4.mp3",
            45:"samples/c4.mp3",
            46:"samples/c4.mp3",
            47:"samples/c4.mp3",
            
            48:"samples/c4.mp3",
            49:"samples/c4.mp3",
            50:"samples/c4.mp3",
            51:"samples/c4.mp3",
            52:"samples/c4.mp3",
            53:"samples/c4.mp3",
            54:"samples/c4.mp3",
            55:"samples/c4.mp3",
            56:"samples/c4.mp3",
            57:"samples/c4.mp3",
            58:"samples/c4.mp3",
            59:"samples/c4.mp3",
            
            60:"samples/c4.mp3",
            61:"samples/c4.mp3",
            62:"samples/c4.mp3",
            63:"samples/c4.mp3",
            64:"samples/c4.mp3",
            65:"samples/c4.mp3",
            66:"samples/c4.mp3",
            67:"samples/c4.mp3",
            68:"samples/c4.mp3",
            69:"samples/c4.mp3",
            70:"samples/c4.mp3",
            71:"samples/c4.mp3",
            
            72:"samples/c4.mp3",
            73:"samples/c4.mp3",
            74:"samples/c4.mp3",
            75:"samples/c4.mp3",
            76:"samples/c4.mp3",
            77:"samples/c4.mp3",
            78:"samples/c4.mp3",
            79:"samples/c4.mp3",
            80:"samples/c4.mp3",
            81:"samples/c4.mp3",
            82:"samples/c4.mp3",
            83:"samples/c4.mp3",
            84:"samples/c4.mp3",

            
          });

    piano.toMaster();

    Tone.Buffer.onload = function(){
      document.getElementById('loading').style.display = 'none';
      console.log('loaded')

      var keyboard = new AudioKeys({
        rows:1,
        polyphony:8
      });

      keyboard.down( function(note) {
        
        console.log(note.note);
        piano.triggerAttack(note.note);
        // Detune each piano sample 
        piano.pitch = tune.note(note.note)-tune.key; 
        console.log("detune", piano.pitch);

        console.log(note);


      });

      keyboard.up( function(note) {
      

      });

    }






    /*
    *
    * Drawing
    *
    *



    var scene = new THREE.Scene();
    var camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );

    var renderer = new THREE.WebGLRenderer();
    renderer.setSize( window.innerWidth, window.innerHeight );
    document.body.appendChild( renderer.domElement );

    var geometry = new THREE.BoxGeometry( 500, 300, 1 );
    var white = new THREE.MeshBasicMaterial( { color: 0xffffff } );
    var black = new THREE.MeshBasicMaterial( { color: 0x110000 } );

   
    */

   
  </script>
</html>
